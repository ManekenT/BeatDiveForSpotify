(this.webpackJsonpbeatdive=this.webpackJsonpbeatdive||[]).push([[0],{16:function(t,e,i){},17:function(t,e,i){},18:function(t,e,i){"use strict";i.r(e);var n=i(1),a=i.n(n),o=i(7),s=i.n(o),r=i(2),c=i(3),l=i(9),u=i(5),d=i(4),h=function(t){var e=t.split("_");return{id:e[0],type:e[1]}},p=i(6),f=i.n(p),m=i(0),g=a.a.createElement,v=new f.a;function y(t){return g("div",{id:"defaultContent"},"Drag and drop a Spotify link over here. Artist, user, song, playlist or album!")}function b(t){return g("div",{className:"overlay"},g("div",{className:"item"},"Please authorize this site with spotify. It doesn't really make sense without access to the Spotify Api."),g("button",{className:"item",id:"authorizeButton",onClick:t.authorize},"Authorize"))}function j(){return g("div",{className:"overlay"},g("div",{},"Something is blocking requests to the spotify api. Please allow this site to access ",g("div",{className:"markedText"},"api.spotify.com")," and refresh the page. Thanks!"))}var k=function(t){Object(u.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(r.a)(this,i),(n=e.call(this,t)).state={track:""},n.trackId=t.id,n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){var t=this;v.getTrack(this.trackId,{},(function(e,i){e&&console.log(),t.setState({track:i})}))}},{key:"render",value:function(){return""!==this.state.track?Object(m.jsx)(O,{title:this.state.track.name,images:this.state.track.album.images,contentType:"Track"}):null}}]),i}(a.a.Component);function O(t){if(t.images[0])var e=g("img",{className:"titleImage item",src:t.images[0].url});return g(a.a.Fragment,{},g("div",{id:"contentType"},t.contentType),g("div",{className:"title"},e,g("h1",{className:"titleText item"},t.title)))}i(16);var w,x,C,T=new f.a,D=function(t){Object(u.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(r.a)(this,i),(n=e.call(this,t)).state={me:""},n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){var t=this;console.log("mounted image"),T.getMe({},(function(e,i){e||t.setState({me:i})}))}},{key:"render",value:function(){return""!==this.state.me?(console.log(this.state.me),Object(m.jsxs)("div",{id:"accountLabel",children:[Object(m.jsx)("img",{id:"accountImage",src:this.state.me.images[0].url}),Object(m.jsx)("div",{id:"accountName",children:this.state.me.display_name})]})):Object(m.jsx)("button",{className:"item",onClick:this.props.authorize,children:"Authorize"})}}]),i}(a.a.Component),N=function(t){Object(u.a)(i,t);var e=Object(d.a)(i);function i(){return Object(r.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){return Object(m.jsxs)("div",{id:"header",children:[Object(m.jsx)("div",{id:"logoText",className:"item",children:"BeatDive for Spotify"}),Object(m.jsx)("div",{children:"load current:"}),Object(m.jsx)("button",{className:"headerButton item",onClick:this.props.loadSong,children:"song"}),Object(m.jsx)("button",{className:"headerButton item",onClick:this.props.loadAlbum,children:"album"}),Object(m.jsx)("button",{className:"headerButton item",onClick:this.props.loadArtist,children:"artist"}),Object(m.jsx)("button",{className:"headerButton item",onClick:this.props.loadPlaylist,children:"playlist"}),Object(m.jsx)(D,{authorize:this.props.authorize})]})}}]),i}(a.a.Component),z=i(8),S=i.n(z),A=(i(17),new f.a),M="authCode",P=function(t){Object(u.a)(i,t);var e=Object(d.a)(i);function i(t){var n,o;if(Object(r.a)(this,i),(n=e.call(this,t)).state={type:"default",id:""},console.log(n.state),window.addEventListener("dragover",(function(t){t.preventDefault()}),!1),window.addEventListener("drop",(function(t){t.preventDefault(),E(t.dataTransfer.getData("text"))}),!1),x=function(){var t=window.location.hash.replace(/#/g,"").split("&"),e={};return t.forEach((function(t){var i=t.split("="),n=i[0];e[n]=i[1]})),e}(),C=function(){var t=window.location.search.replace(/\?/g,"").split("&"),e={};return t.forEach((function(t){var i=t.split("="),n=i[0];e[n]=i[1]})),e}(),x.access_token){w=x.access_token;var s=x.expires_in;s=new Date((new Date).getTime()+1e3*(s-60)),S.a.set(M,w,{expires:s}),x.state?q((o=h(x.state)).id,o.type):window.location.href=window.location.origin}else if(C.error)return Object(l.a)(n,a.a.createElement(b,{authorize:_}));return S.a.get(M)&&(w=S.a.get(M),console.log("Spotify Authentication Code:"+w),A.setAccessToken(w)),C.id&&C.type?(n.state.id=C.id,n.state.type=C.type):x.state&&(o=h(x.state),n.state.id=o.id,n.state.type=o.type),n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t;return console.log(this.state.type),"default"===this.state.type?t=Object(m.jsx)(y,{}):"track"===this.state.type&&(t=Object(m.jsx)(k,{id:this.state.id})),Object(m.jsxs)("div",{children:[Object(m.jsx)(N,{loadSong:I,loadArtist:F,loadUser:J,loadPlaylist:W,loadAlbum:L,authorize:_}),t]})}}]),i}(a.a.Component);function _(){var t="";C.id&&C.type?t="&state="+C.id+"_"+C.type:C.state&&(t="&state="+C.state),window.location.href="https://accounts.spotify.com/authorize?client_id=003e1f0c81d54149b97761a80f6a7270&redirect_uri="+window.location.origin+"&response_type=token&scope=user-read-currently-playing"+t}function B(t){if(401===t.status)S.a.remove(M),_();else{if(0===t.status)return a.a.createElement(j,{});console.error(t)}}function E(t){var e=t.slice(0,25);if("https://open.spotify.com/"===e){var i=t.slice(25,t.length);if(i.startsWith("artist")){var n=i.slice(7,i.length);console.log("Dropped artist id: "+n),q(n,"artist")}else if(i.startsWith("track")){var a=i.slice(6,i.length);console.log("Dropped track id: "+a),q(a,"track")}else if(i.startsWith("album")){var o=i.slice(6,i.length);console.log("Dropped album id: "+o),q(o,"album")}else if(i.startsWith("user")){var s=i.slice(5,i.length);console.log("Dropped user id: "+s),q(s,"user")}else if(i.startsWith("playlist")){var r=i.slice(9,i.length);console.log("Dropped playlist id: "+r),q(r,"playlist")}}else console.log("Not a valid spotify url: "+e)}function I(){console.log("Loading song"),A.getMyCurrentPlayingTrack({},(function(t,e){t?B(t):e.item&&q(e.item.id,"track")}))}function L(){A.getMyCurrentPlayingTrack({},(function(t,e){t?B(t):e.item&&q(e.item.album.id,"album")}))}function F(){A.getMyCurrentPlayingTrack({},(function(t,e){t?B(t):e.item&&q(e.item.artists[0].id,"artist")}))}function W(){A.getMyCurrentPlayingTrack({},(function(t,e){t?B(t):e.context&&"playlist"===e.context.type&&E(e.context.external_urls.spotify)}))}function J(){A.getMe({},(function(t,e){t?B(t):q(e.id,"user")}))}function q(t,e){window.location.href=window.location.origin+"?id="+t+"&type="+e}var U=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,19)).then((function(e){var i=e.getCLS,n=e.getFID,a=e.getFCP,o=e.getLCP,s=e.getTTFB;i(t),n(t),a(t),o(t),s(t)}))};s.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(P,{})}),document.getElementById("root")),U()}},[[18,1,2]]]);
//# sourceMappingURL=main.8f662e7a.chunk.js.map